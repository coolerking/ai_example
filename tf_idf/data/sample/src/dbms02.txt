 分析 ・ 設計 （ データベース ） 。 ここ で は 、 分析 ・ 設計 フェーズ に関する 理解 と 、 重要 な ファクタ で ある キー 、 スキーマ 、 関数 従属 性 について 説明 し ます 。 関係 データモデル 。 関係 データモデル と は 、 関係 データベース を 前提 として 作成 する データモデル の こと です 。 データベース スペシャリスト 試験 で は 、 概念 設計 、 論理 設計 を 題材 と する 場合 、 関係 データモデル が 用い られ て い ます 。 関係 と テーブル 。 関係 データモデル の 「 関係 （ リレーション ） 」 と は 、 2 次元 の 表 （ テーブル ） で 構成 さ れ ます 。 のちほど 関係 データモデル を 図 で 表現 する 学習 を おこない ます が 、 E - R 図 の 「 エンティティ 」 が 関係 、 表 、 テーブル に 相当 し ます 。 属性 と列 。 関係 は 、 一つ 以上 の 属性 （ アトリビュート ） から 構成 さ れ ます 。 例えば 、 関係 「 顧客 」 は 、 「 顧客 番号 」 、 「 顧客 名 」 、 「 住所 」 、 「 年齢 」 という 属性 で 構成 さ れ て い ます 。 属性 は 、 表 の 列 （ カラム ） に 相当 し ます 。 行 と タプル 。 表 の 行 に 当たる 部分 を タプル （ 組 ） と いい ます 。 ドメイン 。 属性 など の 集合 の 取り うる 値 の 範囲 を 、 ドメイン （ 定義 域 ） と いい ます 。 「 顧客 」 表 の 属性 「 顧客 名 」 の ドメイン は 「 田中 一郎 」 、 「 鈴木 太郎 」 、 「 佐藤 花子 」 、 「 小林 次郎 」 の 4 要素 の 集合 を さし ます 。 データベース 管理 システム の 中 に は 、 ドメイン を 制約 として 設定 可能 な もの も あり ます 。 なお 、 オブジェクト 指向 アプローチ を 用いる 場合 、 「 ドメイン 」 は 問題 領域 という 特別 な 意味 づけ し た 用語 として 使用 し ます 。 3 値 理論 。 データベース は 3 値 論理 に 従っ て い ます 。 3 値 論理 と は 、 真 ( true )、 偽 ( false ) の ほか に NULL という 第 3 の 論理 値 を 持つ 論理 こと です 。 データベース で は NULL という 論理 値 が 用意 さ れ て い ます 。 対象 値 が 不明 、 未知 もしくは 適用 不能 で ある 場合 に 使用 し ます 。 真偽 値 型 以外 の 型 で も NULL を 使用 する こと が でき ます 。 また 、 表 に対して NULL を 格納 でき ない 制約 を 適用 する こと が でき ます 。 概念 データモデル の 作成 ・ 検証 。 概念 データモデル の 作成 。 データベース スペシャリスト は 、 整理 さ れ た 要件 を もと に 概念 データモデル を 作成 し ます 。 一般 的 に 「 整理 さ れ た 要件 」 と は 、 表 や 図 、 帳票 や 画面 など の 場合 も あり ます が 、 その 多く は 、 業務 記述 書 の よう な 業務 上 の 仕組み や ルール を 記述 し た 通常 の 文章 です 。 文章 から 関係 や 属性 を 発見 し 、 その 相互 の 関係 を 整理 する 作業 を おこない ます 。 その 際 に 、 名詞 抽出 法 や モノ ・ コト 分析 など を 用い て 、 関係 や 属性 の 候補 を 切り出し ます 。 概念 データモデル は 、 データベース の 種類 に 依存 し ない 表現 で 記述 表記 し ます 。 一般 的 に は E - R 図 を 使っ て 表記 し ます が 、 最近 で は UML の クラス 図 を 用いる 場合 も あり ます 。 ただし 、 経営 者 など 利害 関係 者 が 参照 する 場合 は 、 ほか の 表現 方法 で 記述 する 場合 も あり ます 。 なお 、 データベース スペシャリスト 試験 で は 、 E - R 図 、 クラス 図 以外 の 表記 方法 で は 出題 さ れ ませ ん （ 詳しい 表記 法 について は 、 テーマ 017 を 参照 ） 。 概念 CDM を 管理 し て いる 組織 で は 、 システム 化 対象 部分 を 切り出し て 、 概念 データモデル の ベース として 使用 する こと が あり ます 。 概念 データモデル の 検証 。 データベース スペシャリスト は 、 作成 し た 概念 データモデル が 正しい か 、 ほか の プロジェクト 成果 物 を 用い て 検証 を おこない ます 。 プロジェクト 成果 物 は 、 適用 さ れる プロジェクト 方針 により 異なり ます 。 検証 対象 と なる 成果 物 の 例 です 。 業務 フロー や DFD 、 画面 遷移 図 、 ユース ケース 記述 、 シナリオ 記述 といった プロセス 分析 系 成果 物 、 システム アーキテクチャ 設計 書 や ビジネス ルール など の ゴール 分析 系 成果 物 、 用語 集 や 各種 標準 、 ポリシー など の 参照 系 成果 物 が あり ます 。 それら の 成果 物 と 概念 データモデル と の 間 の 整合 性 を 確認 し ます 。 整合 性 検証 は 、 用語 が 統一 さ れ て いる か 、 想定 し て いる 要件 や プロセス が 実現 可能 で ある か を 確認 し ます 。 プロセス の 検証 は 、 単純 な 成果 物 間 の 比較 だけ で は なく 、 データ の ライフサイクル について も 確認 し ます 。 データ の ライフサイクル 検証 に は 、 CRUD 分析 や ロバストネス 分析 を 用い ます 。 論理 データモデル の 作成 ・ 検証 。 論理 データモデル の 作成 。 データベース スペシャリスト は 、 論理 データモデル 作成 を 担当 し ます 。 論理 データモデル 作成 は 、 適用 する プロジェクト 標準 によって 異なり ます が 、 一般 的 に ソフトウェア 方式 設計 フェーズ で おこない ます 。 論理 データモデル は 、 ソフトウェア アーキテクチャ の 論理 レベル の 設計 方針 を 組み入れ 、 必要 と する 属性 を すべて 洗い出し 、 データ 間 の 関連 を 論理 的 に 表現 し て 作成 し ます 。 一般 的 に は 、 概念 データモデル を もと に 論理 データモデル を 作成 し ます 。 その 際 に は 、 仕様 を 満たす ため の すべて の 属性 を 表記 し 、 データ 間 の 関連 を 明記 し 、 仕様 を 満たす キー など の 制約 を 記載 し ます 。 また 、 可能 な 限り 更新 時 など データ 整合 性 を 保つ こと が できる よう に 、 正規 化 を おこない ます 。 論理 データモデル は 、 対象 と なる データベース の 種類 に あわせ て 表記 法 を 決定 し ます 。 データベース スペシャリスト 試験 で は 、 関係 データモデル を 前提 と し て いる ため 、 E - R 図 や クラス 図 を 使用 し ます 。 そして 完成 し た 論理 データモデル は 、 データベース 上 で 実現 可能 な モデル と なり ます 。 論理 データモデル の 検証 。 データベース スペシャリスト は 、 作成 し た 論理 データモデル が 要件 を 満たす モデル で ある か 、 検証 を おこない ます 。 論理 データモデル の 検証 は 2 段階 あり ます 。 同 一 フェーズ の 成果 物 と の 整合 性 を 検証 。 前 フェーズ まで の 成果 物 と の 整合 性 を 検証 。 検証 対象 成果 物 の 一 例 です 。 同 一 フェーズ の 成果 物 が 、 ソフトウェア アーキテクチャ 設計 書 、 論理 コンポーネント 設計 書 で ある 場合 は 、 論理 コンポーネント 間 の シーケンス 図 を 記述 し て 整合 性 を 確認 し ます 。 そして 関係 データベース の 場合 、 関係 代数 を 用い て 、 論理 データモデル 上 の データ 項目 から 目的 の データ へ 加工 可能 で ある か どう か を 確認 し ます 。 その後 、 前 フェーズ まで の 成果 物 に 記述 さ れ た 要件 を 満たす か どう か 整合 性 検証 を 実施 し ます 。 こちら の 作業 は 概念 データモデル で 実施 し た 作業 と ほぼ 同じ です 。 関係 データモデル と は 、 データ を 関係 （ リレーション ） の 集まり として 表現 し た モデル の こと で ある 。 概念 データモデル は 、 主 に 組織 全体 の 概念 モデル や 整理 さ れ た 要件 を もと に 作成 し 、 CRUD 分析 や ロバストネス 分析 など を 用い て 検証 する 。 論理 データモデル は 、 すべて の 属性 や 関連 が 洗い出さ れ 正規 化 さ れ た 、 データベース 上 で 実現 可能 な モデル で ある 。 キー 。 スーパー キー 。 キー （ 識別子 ） と は 。 関係 データベース における キー と は 、 表 の 検索 や 並び 替え など を おこなう 際 に 比較 の 対象 と なる 一つ 以上 の 属性 の こと です 。 キー に は 、 様々 な 種類 が 存在 し ます 。 「 学生 」 表 を 例 に 、 各々 の キー について 学習 し ましょ う 。 「 学生 」 表 に は 、 とある 中学校 の 全 在籍 学生 が 登録 さ れ て い ます 。 「 学年 」 ： 学年 、 1 から 3 まで の 数値 を 格納 。 「 組 」 ： クラス 名 、 A から 順番 に 最大 Z まで の アルファベット を 格納 。 「 出席 番号 」 ： クラス 内 で 氏名 の 昇順 に 一意 に 割り当て た 番号 。 「 氏名 」 ： 学生 の 氏名 、 同姓 同名 の 場合 も あり 。 スーパー キー 。 行 を 一意 に 識別 できる 属性 もしくは 属性 の 組 を スーパー キー （ super key ） と よび ます 。 「 行 を 一意 に 識別 できる 」 と は 、 存在 する すべて の 行 の 中 から 1 行 を 特定 できる こと を さし ます 。 「 学生 」 表 の スーパー キー は 、 まず すべて の 属性 の 組 で ある { 学年 , 組 , 出席 番号 , 氏名 , 学区 名 } が あげ られ ます 。 次に 各 属性 の 組み合わせ で 「 行 を 一意 に 識別 できる 」 もの を 探し ます 。 同姓 同名 の 生徒 が 同じ 学区 に 住ん で いる 場合 も 考え られる ため 、 「 氏名 」 と 「 学区 名 」 の 値 が 決まっ て も 、 「 学年 」 、 「 組 」 、 「 出席 番号 」 の それぞれ の 値 は 決まる と は 限り ませ ん 。 この ため 、 「 学生 」 表 の スーパー キー は 、 4 組 あり ます 。 候補 キー 。 行 を 一意 に 識別 できる 属性 もしくは 属性 の 組 の うち 極小 の もの を 候補 キー （ candidate key ） と よび ます 。 「 極小 の もの 」 と は 、 評価 中 の 属性 の 組 から どれ か 一つ の 属性 を 削除 し て しまう と 、 行 を 一意 に 識別 でき なく なる もの を さし ます 。 例えば 「 学生 」 表 の スーパー キー の 一つ で ある { 学年 , 組 , 出席 番号 , 氏名 } から 「 氏名 」 を 削除 し て も 、 行 を 一意 に 特定 可能 です 。 この ため 、 { 学年 , 組 , 出席 番号 , 氏名 } は 候補 キー で は あり ませ ん 。 また スーパー キー { 学年 , 組 , 出席 番号 } の 場合 は 、 どの 属性 を 削除 し て も 行 を 一意 に 特定 でき なく なり ます 。 よって { 学年 , 組 , 出席 番号 } は 候補 キー と なり ます 。 主 キー と 代理 キー 。 主 キー 。 主 キー （ primary key ） は 、 候補 キー の 中 から 一つ 選ん だ もの で 、 属性 値 が NULL と なら ない もの です 。 どれ を 選択 する か は 、 データベース を 設計 する 担当 者 が 、 どの よう に 属性 に対して 意味 づけ する か に より ます 。 「 学生 」 表 の 候補 キー { 学年 , 組 , 出席 番号 } の 各 属性 は 、 学生 が 中学校 に 在籍 する 時点 で 「 学年 」 、 「 組 」 、 「 出席 番号 」 が 決まる ため 、 NULL と なり ませ ん 。 この ため { 学年 , 組 , 出席 番号 } は 主 キー として 選択 可能 です 。 ここ で は 主 キー を 選択 し た 前提 で 学習 を 進め ます 。 代理 キー 。 主 キー 以外 の 候補 キー を 代理 キー （ alternate key ） または 2 次 キー （ secondary key ） と よび ます 。 「 学生 」 表 の 候補 キー は 一つ のみ で 、 主 キー として 選択 し て しまっ た ため 、 代理 キー は あり ませ ん 。 平成 20 年 より 前 の データベース スペシャリスト 午前 問題 で は 代理 キー で は なく 代替 キー という 名称 で 出題 さ れ て い まし た 。 今後 再度 代替 キー という 名称 で 出題 さ れる 可能 性 は 低い です が 、 念 の ため こちら の 名称 も 学習 し て おい て ください 。 ここ で データベース に 別 の 「 学区 」 表 を 作成 し 、 「 学区 番号 」 を 使っ て 変更 し まし た 。 「 学区 」 表 の 「 学区 番号 」 ： 学区 名 ごと に 一意 に 採 番 さ れ た 整数 。 「 学区 」 表 の 「 学区 名 」 ： すべて の 学区 名 が 定義 さ れ て おり 、 「 学生 」 表 の 「 学区 名 」 は すべて 「 学区 」 表 に 定義 さ れ て いる 。 「 学区 」 表 の 主 キー ：{ 学区 番号 }。 新 「 学生 」 表 の 「 学区 番号 」 ： 「 学区 」 表 の 「 学区 番号 」 に 置き換え 。 新 「 学生 」 表 の 主 キー ：{ 学年 , 組 , 出席 番号 }。 外部 キー 。 同じ ドメイン を もつ 他 の 表 の 主 キー を 参照 する 属性 もしくは 属性 の 組 を 外部 キー （ foreign key ） と よび ます 。 新 「 学生 」 表 の 「 学区 番号 」 に 対応 する 「 学区 名 」 は すべて 「 学区 」 表 の 主 キー 属性 「 学区 番号 」 の ドメイン 内 に 存在 し ます 。 この ため 新 「 学生 」 表 の 「 学区 番号 」 は 外部 キー です 。 外部 キー を 定義 し た 表 を 参照 表 、 外部 キー によって 参照 表 から 参照 さ れる 表 を 被参照 表 と よび ます 。 この 場合 、 新 「 学生 」 表 が 参照 表 、 「 学区 」 表 が 被参照 表 と なり ます 。 参照 表 へ 行 を 追加 、 変更 する 場合 は 注意 が 必要 です 。 なぜ なら 追加 対象 の 「 学区 番号 」 値 が 「 学区 」 表 の 「 学区 番号 」 ドメイン に 含ま れ て い なく て は なり ませ ん 。 この よう に 外部 キー を 指定 し た 場合 に は 特別 な 制約 が 発生 し ます 。 複合 キー と 代用 キー 。 複合 キー 。 複数 の 属性 で 構成 し て いる キー を 複合 キー （ composite key ） と よび ます 。 「 学生 」 表 の 主 キー は 三つ の 属性 で 構成 し て い ます 。 この ため 「 学生 」 表 の 主 キー { 学年 , 組 , 出席 番号 } は 複合 キー （ 複合 主 キー ） です 。 外部 キー { 学区 番号 } は 単一 の 属性 で 構成 し て いる ので 、 複合 キー で は あり ませ ん 。 代用 キー 。 複数 の 属性 で 構成 さ れる 複合 キー は 扱い が 複雑 に なる こと が あり ます 。 この ため 新規 に 一意 な 属性 を 一つ 作成 し 、 これ を 複合 キー の 代わり に キー として 代用 し ます 。 この よう な キー を 代用 キー （ surrogate key ） と よび ます 。 「 学生 」 表 の 主 キー は 複合 キー で ある ため 、 アプリケーション など で 一 人 の 学生 を 特定 する 際 に 必ず 三つ の 値 を 指定 し なく て は なら ず 面倒 です 。 この よう な 場合 、 以下 の よう な 新た な 属性 「 学籍 番号 」 を 追加 し て 主 キー と し ます 。 新 主 キー 「 学籍 番号 」 は 代用 キー です 。 「 学籍 番号 」 ： 在籍 開始 時 に 各 学生 に 割り当て た 番号 、 中学校 内 で 一意 で あり 、 NULL と なる こと は ない 。 代用 キー で 置き換え られ た 後 の 元 の キー は 代理 キー と なり ます 。 「 学籍 番号 」 を 追加 し た 後 の 「 学生 」 表 です 。 「 学籍 番号 」 を 追加 し た 後 でも 、 前 に 使用 し て い た 主 キー { 学年 , 組 , 出席 番号 } は 候補 キー と なっ て い ます 。 よって { 学年 , 組 , 出席 番号 } は 代理 キー で も あり ます 。 行 を 一意 に 識別 できる 属性 もしくは 属性 の 組 を スーパー キー （ super key ） と よび 、 スーパー キー の うち 極小 の もの を 候補 キー （ candidate key ） と よぶ 。 主 キー （ primary key ） は 、 候補 キー の 中 から 一つ 選ん だ もの で 、 属性 値 が NULL と なら ない もの で ある 。 主 キー 以外 の 候補 キー を 代理 キー （ alternate key ） もしくは 代替 キー と よぶ 。 複数 の 属性 で 構成 し て いる キー を 複合 キー （ composite key ） と よび 、 場合 により 代用 キー （ surrogate key ） を 作成 し 主 キー を 整理 する こと が ある 。 
